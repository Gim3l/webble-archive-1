# Migration `20201031001040`

This migration has been generated by Gimel Dick at 10/30/2020, 8:10:40 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;
CREATE TABLE "new_AssignmentSubmission" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL,
    "path" TEXT NOT NULL,
    "size" INTEGER NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" DATETIME NOT NULL,
    "studentProfileId" INTEGER NOT NULL,
    "assignmentId" INTEGER NOT NULL,

    FOREIGN KEY ("assignmentId") REFERENCES "Assignment"("id") ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY ("studentProfileId") REFERENCES "StudentProfile"("id") ON DELETE CASCADE ON UPDATE CASCADE
);
INSERT INTO "new_AssignmentSubmission" ("id", "name", "path", "size", "createdAt", "updatedAt") SELECT "id", "name", "path", "size", "createdAt", "updatedAt" FROM "AssignmentSubmission";
DROP TABLE "AssignmentSubmission";
ALTER TABLE "new_AssignmentSubmission" RENAME TO "AssignmentSubmission";
PRAGMA foreign_key_check;
PRAGMA foreign_keys=ON
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201031000754..20201031001040
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url = "***"
 }
 model User {
   id             Int             @id @default(autoincrement())
@@ -79,8 +79,9 @@
   updatedAt                 DateTime                    @updatedAt
   user                      User                        @relation(fields: [userId], references: [id])
   StudentProfileOnClassroom StudentProfileOnClassroom[]
   GradeOnStudentProfile     GradeOnStudentProfile[]
+  AssignmentSubmission      AssignmentSubmission[]
 }
 model TeacherProfileOnClassroom {
   teacherProfileId Int
@@ -124,24 +125,29 @@
   name String
 }
 model Assignment {
-  id                Int                 @id @default(autoincrement())
-  name              String?
-  description       String
-  classroomId       Int
-  classroom         Classroom           @relation(fields: [classroomId], references: [id])
-  dueDate           DateTime            @default(now())
-  GradeOnAssignment GradeOnAssignment[]
+  id                   Int                    @id @default(autoincrement())
+  name                 String?
+  description          String
+  classroomId          Int
+  classroom            Classroom              @relation(fields: [classroomId], references: [id])
+  dueDate              DateTime               @default(now())
+  GradeOnAssignment    GradeOnAssignment[]
+  AssignmentSubmission AssignmentSubmission[]
 }
 model AssignmentSubmission {
-  id        Int      @id @default(autoincrement())
-  name      String
-  path      String
-  size      Int
-  createdAt DateTime @default(now())
-  updatedAt DateTime @updatedAt
+  id               Int            @id @default(autoincrement())
+  assignment       Assignment     @relation(fields: [assignmentId], references: [id])
+  student          StudentProfile @relation(fields: [studentProfileId], references: [id])
+  name             String
+  path             String
+  size             Int
+  createdAt        DateTime       @default(now())
+  updatedAt        DateTime       @updatedAt
+  studentProfileId Int
+  assignmentId     Int
 }
 model GradeOnAssignment {
   gradeId      Int
```


